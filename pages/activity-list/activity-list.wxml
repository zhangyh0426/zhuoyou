<!--pages/activity-list/activity-list.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  - å¾®ä¿¡é£æ ¼ -->
  <view class="status-bar">
    <view class="status-left">
      <text class="status-time">{{currentTime}}</text>
    </view>
    <view class="status-right">
      <text class="status-text">ç‹¼äººæ€æ¡Œæ¸¸åº—</text>
    </view>
  </view>

  <!-- é¡¶éƒ¨å¯¼èˆªæ  - å¾®ä¿¡é£æ ¼ -->
  <view class="nav-header">
    <view class="nav-content">
      <text class="nav-title">æ´»åŠ¨åˆ—è¡¨</text>
      <view class="nav-actions">
        <view class="nav-action" bindtap="goToSearch">
          <text class="nav-icon">ğŸ”</text>
        </view>
        <view class="nav-action" bindtap="goToCreateActivity">
          <text class="nav-icon">â•</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾é¡µ - å¾®ä¿¡é£æ ¼ -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'all' ? 'active' : ''}}" data-tab="all" bindtap="switchTab">
      <text class="tab-text">å…¨éƒ¨æ´»åŠ¨</text>
    </view>
    <view class="tab-item {{activeTab === 'today' ? 'active' : ''}}" data-tab="today" bindtap="switchTab">
      <text class="tab-text">ä»Šæ—¥æ´»åŠ¨</text>
    </view>
    <view class="tab-item {{activeTab === 'upcoming' ? 'active' : ''}}" data-tab="upcoming" bindtap="switchTab">
      <text class="tab-text">å³å°†å¼€å§‹</text>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <scroll-view class="main-content" scroll-y="true">
    <!-- æ´»åŠ¨åˆ—è¡¨ - å¾®ä¿¡é£æ ¼ -->
    <view class="activity-section" wx:if="{{filteredActivities.length > 0}}">
      <view class="section-header">
        <text class="section-title">{{activeTab === 'today' ? 'ä»Šæ—¥æ´»åŠ¨' : activeTab === 'upcoming' ? 'å³å°†å¼€å§‹' : 'å…¨éƒ¨æ´»åŠ¨'}}</text>
        <text class="section-count">{{filteredActivities.length}} ä¸ªæ´»åŠ¨</text>
      </view>
      
      <view class="activity-list">
        <view 
          class="activity-item {{item.currentPlayers >= item.maxPlayers ? 'full' : ''}}" 
          wx:for="{{filteredActivities}}" 
          wx:key="id"
          bindtap="viewActivityDetail"
          data-id="{{item.id}}"
        >
          <view class="activity-avatar">
            <text class="avatar-icon">{{item.currentPlayers >= item.maxPlayers ? 'ğŸ”’' : 'ğŸ¯'}}</text>
          </view>
          <view class="activity-content">
            <view class="activity-title-row">
              <text class="activity-tag {{item.currentPlayers >= item.maxPlayers ? 'full' : 'available'}}">
                {{item.currentPlayers >= item.maxPlayers ? 'å·²æ»¡å‘˜' : 'æŠ¥åä¸­'}}
              </text>
              <text class="activity-title">{{item.title}}</text>
            </view>
            <view class="activity-info">
              <text class="activity-date">ğŸ“… {{item.date}}</text>
              <text class="activity-time">â° {{item.time}}</text>
              <text class="activity-players">ğŸ‘¥ {{item.currentPlayers}}/{{item.maxPlayers}}äºº</text>
            </view>
            <view class="activity-progress">
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{(item.currentPlayers / item.maxPlayers) * 100}}%"></view>
              </view>
              <text class="progress-text">{{Math.round((item.currentPlayers / item.maxPlayers) * 100)}}%</text>
            </view>
            <view class="activity-footer">
              <view class="organizer-info">
                <text class="organizer-label">ç»„ç»‡è€…</text>
                <text class="organizer-name">{{item.creator.name}}</text>
              </view>
              <view class="join-btn {{item.currentPlayers >= item.maxPlayers ? 'disabled' : ''}}" 
                    wx:if="{{item.currentPlayers < item.maxPlayers}}" 
                    bindtap="joinActivity" 
                    data-id="{{item.id}}">
                <text class="btn-text">ç«‹å³æŠ¥å</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ - å¾®ä¿¡é£æ ¼ -->
    <view class="empty-section" wx:if="{{filteredActivities.length === 0}}">
      <view class="empty-card">
        <view class="empty-icon">ğŸ²</view>
        <text class="empty-title">æš‚æ— æ´»åŠ¨</text>
        <text class="empty-desc">{{activeTab === 'today' ? 'ä»Šæ—¥æš‚æ— æ´»åŠ¨' : activeTab === 'upcoming' ? 'æš‚æ— å³å°†å¼€å§‹çš„æ´»åŠ¨' : 'è¿˜æ²¡æœ‰ä»»ä½•æ´»åŠ¨'}}</text>
        <view class="empty-action" bindtap="goToCreateActivity">
          <text class="action-text">åˆ›å»ºæ´»åŠ¨</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨é—´è· -->
    <view class="bottom-spacing"></view>
  </scroll-view>

  <!-- åº•éƒ¨æ ‡ç­¾æ å ä½ -->
  <view class="tab-bar-placeholder"></view>
</view>